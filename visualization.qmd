---
title: ""
format: html
editor_options: 
  chunk_output_type: console
---

## Creating Visualizations from Data Packages

As the title suggests, this section will aim to describe how to create plots in different ways with a focus on reproducibility and collaboration. In this perspective, I believe making descriptive comments about you wrangle and plot your data is key, especially with collaboration in mind - both for your own and others sake. Doing this should make it much easier for yourself and others to pick up the work where you left of. 

### Prior to plotting

Since we already have a data package that should cleanup and ready our data (or at least close to ready) for visualization, we can simply import the data from this package. <!-- I'll be using my own data package here, since it would be contrary to progress to wait for the data package to be finished in section 4. -->

<!-- the code chunk below simply hides/shows code in the output (echo), supresses messages produced from R functions, and warnings - and it makes it default for all code chunks-->
```{r, setup, include=FALSE}

knitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE)

```

The package from which we will import data is organized by test, meaning one xlsx file per test with no other info than what was measured in each specific test. Thus, it is necessary to wrangle and tidy the data a bit further, to get all the information we would like to visualize (such as what age group, condition and allocation each participant had). An almost surprising amount of time can go into this process before you even start plotting, but tidy data will make plotting quite a lot easier. 

```{r, data import and wrangling}
library(tidyverse)
library(dplyr)

## Importing the data from the data package

humac.dat <- reliefdata::relief_humac # this is the peak torque test data

condition <- reliefdata::relief_volume %>% # this is info about volume condition
  mutate(participant = as.character(participant))

participants <- reliefdata::relief_participants %>% # this is info about age group and allocation
  
  mutate(age_group = if_else(age < 40, "yng", "old"))

# It would probably be a good idea to make 1 dataset overall from relief_volum and relief_participants - as a note to self



## Joining the data sets

# Joining condition and participant info
humac.dat <- humac.dat %>%
  # Using left_join to add the info from condition and participants to humac.dat
  left_join(condition) %>%
  # There is no "arm" data from this test, so we exclude it
  select(-arm) %>% 
  
  left_join(participants) %>%
  
  mutate(age_group = factor(age_group, levels = c("yng", "old")),
         # using factor() to sort the order of the respective variables
         condition = factor(condition, levels = c("low", "mod")),
         
         time = factor(time, levels = c("pre", "mid",  "post")),
         
         speed = factor(speed, levels = c("0", "60", "120", "240")),
         
         allocation = factor(allocation, levels = c("int", "con")),
         # case_when makes sure that control participants are not grouped with a volum                condition
         condition = case_when(participant %in% c("3071", "3075", "3076", 
                                                  "3083", "3084", "3085",
                                                  "3086", "3090", "3091",
                                                  "3094") ~ "none", TRUE ~ condition))

## Further data wrangling
# The data set contains 2x test per time point, so I've decided to take the highest value observed at each time point for analysis. Another option would be to take the average from each time point. Getting the highest observed measurement from each time point could be done using the summarise() function alone, however, this produced alot of NA's and corresponding errors. Therefore I've included the below code, which makes a functions that returns proper NA values where all values are NA for a group.


safe_max <- function(x) {
  if (all(is.na(x))) return(NA_real_)
  max(x, na.rm = TRUE)
}

safe_min <- function(x) {
  if (all(is.na(x))) return(NA_real_)
  min(x, na.rm = TRUE)
}


## Step-by-step explanation:
#1. function(x) - This creates a function that takes one input called x (which will be your vector of values)
#2. if (all(is.na(x))) - This checks the condition:

#is.na(x) checks each element and returns TRUE/FALSE for each
#all() checks if ALL elements are TRUE
#So this asks: "Are ALL values in x missing (NA)?"

#3. return(NA_real_) - If all values are NA:

#Return NA_real_ (which is specifically a numeric NA, as opposed to NA_character_ or NA_integer_)
#return() immediately exits the function

#4. max(x, na.rm = TRUE) - If NOT all values are NA:

#Calculate the maximum, ignoring any NAs that exist
#This line only runs if the if condition is FALSE

## Get max values for all outcomes
# With the new "safe_max" variable, we can safely get the highest measurements without producing erroneous NAs.

max.dat <- humac.dat %>%
  filter(!participant == "3012") %>% # Missing data
  group_by(participant, time, leg, speed, condition, age_group, allocation, sex) %>%
  summarise(pt_max = safe_max(pt),
            power_max = safe_max(rep_power),
            work_max = safe_max(rep_work),
            tt_min = safe_min(pt_tt),
            angle = mean(pt_angle, na.rn = TRUE),
            .groups = "drop")


## Reshape the data to long format for faceting
# This simply formats the data to where each observation is stored in its own row, with variables spread
# across columns - thus minimizing redundancy. 

long.dat <- max.dat %>%
  pivot_longer(names_to = "outcome",
               values_to = "value",
               cols = c(pt_max, power_max, work_max, tt_min, angle))

## Filter by speed and parameter
# Below separate data sets for the different velocities are created with the filter() function, also filtering to only the peak torque measurement, since thats what Im interested in here. This could also be done in the plot itself, but I prefer it this way to minimize the amount of code that goes into the actual plot. This might be a personal preference, and there's probably better ways to do it. 

# Isometric/ 0 d/s

ptisom <- long.dat %>%
  filter(speed == "0", outcome == "pt_max")


# 60 d/s

pt60 <- long.dat %>%
  filter(speed == "60", outcome == "pt_max")

  
# 120 d/s

pt120 <- long.dat %>%
  filter(speed == "120", outcome == "pt_max")


# 240 d/s

pt240 <- long.dat %>%
  filter(speed == "240", outcome == "pt_max")


```


### Plotting some figures

Now that the data is tidied up for our purpose, we can make some different plots. The backbone of these plots will be the ggplot() function from ggplot2 (also loaded by tidyverse), and in addition we will also use cowplot for some more toys. Briefly, ggplot2 

**Plot 1: Individual Changes in Peak Torque at 0 (isometric), 60, 120 and 240 d/S**

```{r, Plot1}

library(cowplot)

## Peak torque Isometric

ptisom.plot <- ptisom %>%
  ggplot(aes(x = time, y = value, group = interaction(participant, leg))) +
  geom_line(aes(color = condition), alpha = 0.3) +
  geom_point(aes(color = condition), alpha = 0.3, size = 1) +
  facet_wrap(vars(age_group, allocation), scales = "fixed") +
  scale_color_manual(values = c("low" = "#E69F00", "mod" = "#56B4E9", "none" = "gray50"),
                     name = "Training Volume") +
  labs(title = "",
       subtitle = "",
       x = "",
       y = "Peak Torque (Nm)") +
  theme_minimal() +
  theme(legend.position = "bottom",
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        axis.line = element_line(color = "black"),
        axis.line.x = element_blank(),
        axis.text.x = element_blank(),
        strip.text = element_blank())

## Peak torque 60

pt60.plot <- pt60 %>%
  ggplot(aes(x = time, y = value, group = interaction(participant, leg))) +
  geom_line(aes(color = condition), alpha = 0.3) +
  geom_point(aes(color = condition), alpha = 0.3, size = 1) +
  facet_wrap(vars(age_group, allocation), scales = "fixed") +
  scale_color_manual(values = c("low" = "#E69F00", "mod" = "#56B4E9", "none" = "gray50"),
                     name = "Training Volume") +
  labs(title = "",
       subtitle = "",
       x = "",
       y = "") +
  theme_minimal() +
  theme(legend.position = "bottom") +
  theme(panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        axis.line = element_line(color = "black"),
        axis.line.x = element_blank(),
        axis.text.x = element_blank())

## Peak torque 120

pt120.plot <- pt120 %>%
  ggplot(aes(x = time, y = value, group = interaction(participant, leg))) +
  geom_line(aes(color = condition), alpha = 0.3) +
  geom_point(aes(color = condition), alpha = 0.3, size = 1) +
  facet_wrap(vars(age_group, allocation), scales = "fixed") +
  scale_color_manual(values = c("low" = "#E69F00", "mod" = "#56B4E9", "none" = "gray50"),
                     name = "Training Volume") +
  labs(title = "",
       subtitle = "",
       x = "Time",
       y = "Peak Torque (Nm)") +
  theme_minimal() +
  theme(legend.position = "bottom") +
  theme(panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        axis.line = element_line(color = "black"))

## Peak torque 240

pt240.plot <- pt240 %>%
  ggplot(aes(x = time, y = value, group = interaction(participant, leg))) +
  geom_line(aes(color = condition), alpha = 0.3) +
  geom_point(aes(color = condition), alpha = 0.3, size = 1) +
  facet_wrap(vars(age_group, allocation), scales = "fixed") +
  scale_color_manual(values = c("low" = "#E69F00", "mod" = "#56B4E9", "none" = "gray50"),
                     name = "Training Volume") +
  labs(title = "",
       subtitle = "", #Each line represents one leg from one participant
       x = "Time",
       y = "") +
  theme_minimal() +
  theme(legend.position = "bottom",
        legend.box.margin = margin(0, 0, 0, 0)) +
  theme(panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        axis.line = element_line(color = "black"))




# Combinding the plots

ptfig <- plot_grid(
  ptisom.plot + theme(legend.position = "none"),
  pt60.plot + theme(legend.position = "none"),
  pt120.plot,
  pt240.plot,
  ncol = 2,
  nrow = 2,
  labels = c("A) 0 d/s", "B) 60 d/s", "C) 120 d/s", "D) 240 d/s"),
  rel_heights = c(0.8, 1) 
)


ptfig



```



<!--**Plot 2: Mean Change Peak Torque per Age Group**-->

```{r, Plot2}


## Isometric 
#
#ptisommean <- ptisom %>%
#  #summarising means
#  group_by(age_group, allocation, condition, time) %>%
#  summarise(mean = mean(value, na.rm = TRUE),
#            sd = sd(value, na.rm = TRUE),
#            .groups = "drop" ) %>%
#  
#  #creating the plot
#  ggplot(aes(x = time, y = mean, color = condition, group = condition)) +
#  
#  geom_line(linewidth = 1, position = position_dodge(.2)) +
#  geom_point(size = 3, position = position_dodge(.2)) +
#  geom_errorbar(aes(ymin = mean - sd, ymax = mean + sd),
#                width = 0.1, linewidth = 0.8, position = position_dodge(.2)) +
#  
#  facet_wrap(vars(age_group, allocation), scales = "fixed") +
#  
#  scale_color_manual(values = c("low" = "#E69F00", "mod" = "#56B4E9", "none" = "gray50"),
#                     name = "Training Volume") +
#  
#  labs(title = "",
#       subtitle = "",
#       x = "",
#       y = "Peak Torque (Nm)") +
#  
#  theme_minimal() +
#  theme(legend.position = "bottom") +
#  theme(panel.grid.major = element_blank(),
#        panel.grid.minor = element_blank(),
#        axis.line = element_line(color = "black"),
#        axis.text.x = element_blank(),
#        axis.line.x = element_blank())
#
#
## 60 d/s
#pt60mean <- pt60 %>%
#  #summarising means
#  group_by(age_group, allocation, condition, time) %>%
#  summarise(mean = mean(value, na.rm = TRUE),
#            sd = sd(value, na.rm = TRUE),
#            .groups = "drop" ) %>%
#  
#  #creating the plot
#  ggplot(aes(x = time, y = mean, color = condition, group = condition)) +
#  
#  geom_line(linewidth = 1, position = position_dodge(.2)) +
#  geom_point(size = 3, position = position_dodge(.2)) +
#  geom_errorbar(aes(ymin = mean - sd, ymax = mean + sd),
#                width = 0.1, linewidth = 0.8, position = position_dodge(.2)) +
#  
#  facet_wrap(vars(age_group, allocation), scales = "fixed") +
#  
#  scale_color_manual(values = c("low" = "#E69F00", "mod" = "#56B4E9", "none" = "gray50"),
#                     name = "Training Volume") +
#  
#  labs(title = "",
#       subtitle = "",
#       x = "",
#       y = "") +
#  
#  theme_minimal() +
#  theme(legend.position = "bottom") +
#  theme(panel.grid.major = element_blank(),
#        panel.grid.minor = element_blank(),
#        axis.line = element_line(color = "black"),
#        axis.text.x = element_blank(),
#        axis.line.x = element_blank())
#
#
## 120 d/s
#pt120mean <- pt120 %>%
#  #summarising means
#  group_by(age_group, allocation, condition, time) %>%
#  summarise(mean = mean(value, na.rm = TRUE),
#            sd = sd(value, na.rm = TRUE),
#            .groups = "drop" ) %>%
#  
#  #creating the plot
#  ggplot(aes(x = time, y = mean, color = condition, group = condition)) +
#  
#  geom_line(linewidth = 1, position = position_dodge(.2)) +
#  geom_point(size = 3, position = position_dodge(.2)) +
#  geom_errorbar(aes(ymin = mean - sd, ymax = mean + sd),
#                width = 0.1, linewidth = 0.8, position = position_dodge(.2)) +
#  
#  facet_wrap(vars(age_group, allocation), scales = "fixed") +
#  
#  scale_color_manual(values = c("low" = "#E69F00", "mod" = "#56B4E9", "none" = "gray50"),
#                     name = "Training Volume") +
#  
#  labs(title = "",
#       subtitle = "",
#       x = "Time",
#       y = "Peak Torque (Nm)") +
#  
#  theme_minimal() +
#  theme(legend.position = "bottom") +
#  theme(panel.grid.major = element_blank(),
#        panel.grid.minor = element_blank(),
#        axis.line = element_line(color = "black"))
#
#
## 120 d/s
#pt240mean <- pt240 %>%
#  #summarising means
#  group_by(age_group, allocation, condition, time) %>%
#  summarise(mean = mean(value, na.rm = TRUE),
#            sd = sd(value, na.rm = TRUE),
#            .groups = "drop" ) %>%
#  
#  #creating the plot
#  ggplot(aes(x = time, y = mean, color = condition, group = condition)) +
#  
#  geom_line(linewidth = 1, position = position_dodge(.2)) +
#  geom_point(size = 3, position = position_dodge(.2)) +
#  geom_errorbar(aes(ymin = mean - sd, ymax = mean + sd),
#                width = 0.1, linewidth = 0.8, position = position_dodge(.2)) +
#  
#  facet_wrap(vars(age_group, allocation), scales = "fixed") +
#  
#  scale_color_manual(values = c("low" = "#E69F00", "mod" = "#56B4E9", "none" = "gray50"),
#                     name = "Training Volume") +
#  
#  labs(title = "",
#       subtitle = "",
#       x = "Time",
#       y = "") +
#  
#  theme_minimal() +
#  theme(legend.position = "bottom") +
#  theme(panel.grid.major = element_blank(),
#        panel.grid.minor = element_blank(),
#        axis.line = element_line(color = "black"))
#
#
## Combinding the plots
#
#ptmeanfig <- plot_grid(
#  ptisommean + theme(legend.position = "none"),
#  pt60mean + theme(legend.position = "none"),
#  pt120mean,
#  pt240mean,
#  ncol = 2,
#  nrow = 2,
#  labels = c("A) Isometric", "B) 60 d/s", "C) 120 d/s", "D) 240 d/s"),
#  rel_heights = c(0.8, 1) 
#)
#
#
#ptmeanfig
#
#

```



**Plot 3: Mean Change Peak Torque per Age Group - with raw data**

```{r, Plot3}

# Set seed for jitter

set.seed(1)

# Isometric 

ptiisommean <- ptisom %>%
  #summarising means
  group_by(age_group, allocation, condition, time) %>%
  summarise(mean = mean(value, na.rm = TRUE),
            sd = sd(value, na.rm = TRUE),
            .groups = "drop" ) %>%
  
  #creating the plot
  ggplot(aes(x = time, y = mean, color = condition, group = condition)) +
  
  geom_line(linewidth = 1, position = position_dodge(.5)) +
  geom_point(shape = 21, aes(fill = condition), color = "black",
             size = 3, stroke = 1, position = position_dodge(.5)) +
#  geom_errorbar(aes(ymin = mean - sd, ymax = mean + sd),
#                width = 0.1, linewidth = 0.8, position = position_dodge(.2)) +

  # adding in the raw data
  geom_point(data = ptisom,
             aes(x = time, y = value,
                 color = condition, group = condition),
                 size = 1.5,
                 alpha = 0.3,
             position = position_jitter(width = 0.2)) +
  
  facet_wrap(vars(age_group, allocation), scales = "fixed") +
  
  scale_color_manual(values = c("low" = "#E69F00", "mod" = "#56B4E9", "none" = "gray50"),
                     name = "Training Volume") +  # <-- hide the color legend
  
  scale_fill_manual(values = c("low" = "#E69F00", "mod" = "#56B4E9", "none" = "gray50"),
                    guide = "none") +  # <-- add fill scale
  
  labs(title = "",
       subtitle = "",
       x = "",
       y = "Peak Torque (Nm)") +
  
  theme_minimal() +
  theme(legend.position = "bottom") +
  theme(panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        axis.line = element_line(color = "black"),
        axis.text.x = element_blank(),
        axis.line.x = element_blank())


# 60 d/s
pti60mean <- pt60 %>%
  #summarising means
  group_by(age_group, allocation, condition, time) %>%
  summarise(mean = mean(value, na.rm = TRUE),
            sd = sd(value, na.rm = TRUE),
            .groups = "drop" ) %>%
  
  #creating the plot
  ggplot(aes(x = time, y = mean, color = condition, group = condition)) +
  
  geom_line(linewidth = 1, position = position_dodge(.5)) +
  geom_point(shape = 21, aes(fill = condition), color = "black",
             size = 3, stroke = 1, position = position_dodge(.5)) +
 # geom_errorbar(aes(ymin = mean - sd, ymax = mean + sd),
#                width = 0.1, linewidth = 0.8, position = position_dodge(.2)) +
  
  # adding in the raw data
  geom_point(data = pt60,
             aes(x = time, y = value,
                 color = condition, group = condition),
                 size = 1.5,
                 alpha = 0.3,
             position = position_jitter(width = 0.2)) +
  
  facet_wrap(vars(age_group, allocation), scales = "fixed") +
  
  scale_color_manual(values = c("low" = "#E69F00", "mod" = "#56B4E9", "none" = "gray50"),
                     name = "Training Volume") +  # <-- hide the color legend
  
  scale_fill_manual(values = c("low" = "#E69F00", "mod" = "#56B4E9", "none" = "gray50"),
                    guide = "none") +  # <-- add fill scale
  
  labs(title = "",
       subtitle = "",
       x = "",
       y = "") +
  
  theme_minimal() +
  theme(legend.position = "bottom") +
  theme(panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        axis.line = element_line(color = "black"),
        axis.text.x = element_blank(),
        axis.line.x = element_blank())


# 120 d/s
pti120mean <- pt120 %>%
  #summarising means
  group_by(age_group, allocation, condition, time) %>%
  summarise(mean = mean(value, na.rm = TRUE),
            sd = sd(value, na.rm = TRUE),
            .groups = "drop" ) %>%
  
  #creating the plot
  ggplot(aes(x = time, y = mean, color = condition, group = condition)) +
  
  geom_line(linewidth = 1, position = position_dodge(.5)) +
  geom_point(shape = 21, aes(fill = condition), color = "black",
             size = 3, stroke = 1, position = position_dodge(.5)) +
 # geom_errorbar(aes(ymin = mean - sd, ymax = mean + sd),
  #              width = 0.1, linewidth = 0.8, position = position_dodge(.2)) +
  
  # adding in the raw data
  geom_point(data = pt120,
             aes(x = time, y = value,
                 color = condition, group = condition),
                 size = 1.5,
                 alpha = 0.3,
             position = position_jitter(width = 0.2)) +
  
  facet_wrap(vars(age_group, allocation), scales = "fixed") +
  
  scale_color_manual(values = c("low" = "#E69F00", "mod" = "#56B4E9", "none" = "gray50"),
                     name = "Training Volume") +  # <-- hide the color legend
  
  scale_fill_manual(values = c("low" = "#E69F00", "mod" = "#56B4E9", "none" = "gray50"),
                    guide = "none") +  # <-- add fill scale
  
  labs(title = "",
       subtitle = "",
       x = "Time",
       y = "Peak Torque (Nm)") +
  
  theme_minimal() +
  theme(legend.position = "bottom") +
  theme(panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        axis.line = element_line(color = "black"))


# 240 d/s
pti240mean <- pt240 %>%
  #summarising means
  group_by(age_group, allocation, condition, time) %>%
  summarise(mean = mean(value, na.rm = TRUE),
            sd = sd(value, na.rm = TRUE),
            .groups = "drop" ) %>%
  
  #creating the plot
  ggplot(aes(x = time, y = mean, color = condition, group = condition)) +
  
  geom_line(linewidth = 1, position = position_dodge(.5)) +
  geom_point(shape = 21, aes(fill = condition), color = "black",
             size = 3, stroke = 1, position = position_dodge(.5)) +
  #geom_errorbar(aes(ymin = mean - sd, ymax = mean + sd),
   #             width = 0.1, linewidth = 0.8, position = position_dodge(.2)) +
  
  # adding in the raw data
  geom_point(data = pt240,
             aes(x = time, y = value,
                 color = condition, group = condition),
                 size = 1.5,
                 alpha = 0.3,
             position = position_jitter(width = 0.2)) +
  
  facet_wrap(vars(age_group, allocation), scales = "fixed") +
  
  scale_color_manual(values = c("low" = "#E69F00", "mod" = "#56B4E9", "none" = "gray50"),
                     name = "Training Volume") +  # <-- hide the color legend
  
  scale_fill_manual(values = c("low" = "#E69F00", "mod" = "#56B4E9", "none" = "gray50"),
                    guide = "none") +  # <-- add fill scale
  
  labs(title = "",
       subtitle = "",
       x = "Time",
       y = "") +
  
  theme_minimal() +
  theme(legend.position = "bottom") +
  theme(panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        axis.line = element_line(color = "black"))



# Combinding the plots

ptimeanfig <- plot_grid(
  ptiisommean + theme(legend.position = "none"),
  pti60mean + theme(legend.position = "none"),
  pti120mean + theme(legend.position = "none"),
  pti240mean + theme(legend.position = "none"),
  ncol = 2,
  nrow = 2,
  labels = c("A) Isometric", "B) 60 d/s", "C) 120 d/s", "D) 240 d/s"),
  label_size = 8
)



ptimeanfig

```



**Plot 4: Mean Peak Torque change in a Hill curve format**

```{r, Plot4}

# Calculating group means
curve.sum <- long.dat %>%
  filter(outcome == "pt_max") %>%
  group_by(age_group, allocation, time, speed) %>%
  summarise(mean_torque = mean(value, na.rm = TRUE),
            se_torque = sd(value, na.rm = TRUE) / sqrt(n()),
            .groups = "drop")

# Creating a combined group variable for easier plotting
curve.sum <- curve.sum %>%
  mutate(group = paste(age_group, allocation, sep = "_"))


# Plot 1: Comparing changes over time (baseline + halfway + post)
# Separate panels for each group

plot_time <- curve.sum %>%
  ggplot(aes(x = speed, y = mean_torque, color = time, group = time)) +
  geom_line(linewidth = 1) +
  #geom_point(size = 3) +
  #geom_errorbar(aes(ymin = mean_torque - se_torque, 
  #                  ymax = mean_torque + se_torque), 
  #              width = 10) +
  facet_wrap(~ age_group + allocation, ncol = 3) +
  labs(x = "Angular Velocity (d/s)",
       y = "Peak Torque (Nm)",
       color = "Time Point",
       title = "Force-Velocity Curves Across Training") +
  theme_classic() +
  theme(legend.position = "bottom")


# Plot 2: Single plot showing everything (might be busy)
curve.plot <- curve.sum %>%
  ggplot(aes(x = speed, y = mean_torque, color = group, linetype = time, 
             group = interaction(group, time))) +
  geom_line(linewidth = 1) +
  geom_point(size = 2) +
  labs(x = "Angular Velocity (d/s)",
       y = "Peak Torque (Nm)",
       color = "Group",
       linetype = "Time Point",
       title = "") +
  scale_color_manual(values = c("yng_int" = "#E69F00",
                                  "old_int" = "#56B4E9",
                                  "old_con" = "gray50"),
                     labels = c("yng_int" = "Young Intervention", 
                                "old_int" = "Old Intervention", 
                                "old_con" = "Old Control")) +
  theme_classic() +
  theme(legend.position = "bottom")


curve.plot




```




